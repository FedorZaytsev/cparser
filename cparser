import lexer
import analyzer
import argparse
import debug
import sys
import time

def dropResult(res, filename):
    with open(filename+'.a','w') as f:
        f.write(debug.Node2Json(res))

def main():
    parser = argparse.ArgumentParser(description='C language parser')
    parser.add_argument('input', help='input file')
    args = parser.parse_args()

    print("parsing {}".format(args.input))

    f = open(args.input, "r")

    start = time.time()
    #try:
    l = lexer.Lexer(f.read())

    a = analyzer.Analyzer(l)

    res = a.parse()
    end = time.time()
    debug.printNodeWithSkip(res)
    #dropResult(res, args.input)

    print("Time passed {}".format(end - start))
    #except:
    #    print("Error occurred during parsing {}".format(args.input))
    #    sys.exit(1)
    


if __name__ == "__main__":
    main()
